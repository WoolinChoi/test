I"ªÀ<h1 id="join"><a href="">join</a></h1>

<h2 id="join-1">Join</h2>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- 1. ì—…ë¬´ë³„, ë¶€ì„œë³„ ê¸‰ì—¬ í•©ê³„ì™€ ì¸ì›ìˆ˜ë¥¼ ì¶œë ¥í•˜ë˜, 10ë²ˆ ë¶€ì„œë¥¼ ì œì™¸í•˜ê³  ì—…ë¬´ê°€ â€˜SALESMANâ€™ê³¼ â€˜MANAGERâ€™ë§Œ ì¶œë ¥í•œë‹¤.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">emp</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="k">sum</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">sum</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">job</span><span class="p">,</span> <span class="n">deptno</span>
<span class="k">FROM</span> <span class="n">emp</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">job</span><span class="p">,</span> <span class="n">deptno</span>
<span class="k">HAVING</span> <span class="n">deptno</span> <span class="o">&lt;&gt;</span> <span class="mi">10</span> <span class="k">AND</span> <span class="p">(</span><span class="n">job</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'SALESMAN'</span><span class="p">,</span> <span class="s1">'MANAGER'</span><span class="p">));</span>

<span class="c1">-- 2. ì—…ë¬´ë³„ë¡œ í‰ê· ê¸‰ì—¬ì™€ ìµœëŒ€ê¸‰ì—¬ë¥¼ ì¶œë ¥í•˜ë˜, í‰ê· ê¸‰ì—¬ê°€ 2000ì´ìƒì¸ ê²ƒë§Œ ì¶œë ¥í•˜ê³  í‰ê· ê¸‰ì—¬ê°€ ë†’ì€ ìˆœìœ¼ë¡œ ì •ë ¬</span>
<span class="k">SELECT</span> <span class="n">round</span><span class="p">(</span><span class="k">avg</span><span class="p">(</span><span class="n">sal</span><span class="p">))</span> <span class="k">avg</span><span class="p">,</span> <span class="k">max</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">max</span><span class="p">,</span> <span class="n">job</span>
<span class="k">FROM</span> <span class="n">emp</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">job</span>
<span class="k">HAVING</span> <span class="n">round</span><span class="p">(</span><span class="k">avg</span><span class="p">(</span><span class="n">sal</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">2000</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">avg</span> <span class="k">DESC</span><span class="p">;</span>

<span class="c1">-- 3. 5ê°œì”© ê¸‰ì—¬í•©ê³„ì™€ ì¸ì›ìˆ˜ë¥¼ ì¶œë ¥ (rownumì´ìš©)</span>
<span class="k">SELECT</span> <span class="n">ceil</span><span class="p">(</span><span class="n">ROWNUM</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span> <span class="n">grp</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">sum</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">cnt</span>
<span class="k">FROM</span> <span class="n">emp</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">ceil</span><span class="p">(</span><span class="n">ROWNUM</span><span class="o">/</span><span class="mi">5</span><span class="p">);</span>

<span class="c1">-- 4. ê°™ì€ ì…ì‚¬ë…„ë„ ë³„ë¡œ ì¸ì›ìˆ˜ë¥¼ ì¶œë ¥</span>
<span class="k">SELECT</span> <span class="n">to_char</span><span class="p">(</span><span class="n">HIREDATE</span><span class="p">,</span> <span class="s1">'YYYY'</span><span class="p">)</span> <span class="n">hd</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">cnt</span>
<span class="k">FROM</span> <span class="n">emp</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">to_char</span><span class="p">(</span><span class="n">HIREDATE</span><span class="p">,</span> <span class="s1">'YYYY'</span><span class="p">);</span>

<span class="c1">-- 5. ë‹¤ìŒê³¼ ê°™ì´ ì¶œë ¥</span>
<span class="cm">/*
   CLERK     SALESMAN MANAGER       (ì—…ë¬´ëª…)
-----------------------------------------------------------------------
     4           4       3           (ì¸ì›ìˆ˜)
 */</span>
<span class="c1">-- GROUP BYì— ì•ˆë“¤ì–´ê°€ë¯€ë¡œ countë³´ë‹¤ sumì„ ì´ìš©í•œë‹¤.</span>
<span class="k">SELECT</span> <span class="k">sum</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="s1">'CLERK'</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="n">clerk</span><span class="p">,</span> 
<span class="k">sum</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="s1">'SALESMAN'</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="n">salesman</span><span class="p">,</span> 
<span class="k">sum</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="s1">'MANAGER'</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="n">manager</span>
<span class="k">FROM</span> <span class="n">emp</span><span class="p">;</span>
<span class="c1">-- caseë¬¸ í™œìš©</span>
<span class="k">SELECT</span> <span class="k">sum</span><span class="p">(</span><span class="k">case</span> <span class="n">job</span> <span class="k">WHEN</span> <span class="s1">'CLERK'</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">END</span><span class="p">)</span> <span class="n">clerk</span><span class="p">,</span>
<span class="k">sum</span><span class="p">(</span><span class="k">case</span> <span class="n">job</span> <span class="k">WHEN</span> <span class="s1">'SALESMAN'</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">END</span><span class="p">)</span> <span class="n">salesman</span><span class="p">,</span>
<span class="k">sum</span><span class="p">(</span><span class="k">case</span> <span class="n">job</span> <span class="k">WHEN</span> <span class="s1">'MANAGER'</span> <span class="k">THEN</span> <span class="mi">1</span> <span class="k">END</span><span class="p">)</span> <span class="n">manager</span>
<span class="k">FROM</span> <span class="n">emp</span><span class="p">;</span>
    
<span class="c1">-- 6. ë‹¤ìŒê³¼ ê°™ì´ ì¶œë ¥</span>
<span class="cm">/*
ì—…ë¬´ëª…  10ë²ˆë¶€ì„œ 20ë²ˆë¶€ì„œ 30ë²ˆë¶€ì„œ ê¸‰ì—¬í•©ê³„
------------------------------------------
CLERK  1300  1900     950  4150
SALESMAN 0     0    5600   5600
PRESIDENT 5000     0       0  5000
MANAGER    2450  2975    2850  8275
ANALYST     0  6000       0  6000
 */</span>
<span class="k">SELECT</span> <span class="n">job</span> <span class="nv">"ì—…ë¬´ëª…"</span><span class="p">,</span>
<span class="k">sum</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">deptno</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">sal</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="nv">"10ë²ˆ ë¶€ì„œ"</span><span class="p">,</span>
<span class="k">sum</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">deptno</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">sal</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="nv">"20ë²ˆ ë¶€ì„œ"</span><span class="p">,</span>
<span class="k">sum</span><span class="p">(</span><span class="n">decode</span><span class="p">(</span><span class="n">deptno</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">sal</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="nv">"30ë²ˆ ë¶€ì„œ"</span><span class="p">,</span>
<span class="k">sum</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="nv">"ê¸‰ì—¬ í•©ê³„"</span>
<span class="k">FROM</span> <span class="n">emp</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">job</span><span class="p">;</span>
<span class="c1">-- caseë¬¸ í™œìš©</span>
<span class="k">SELECT</span> <span class="n">job</span> <span class="nv">"ì—…ë¬´ëª…"</span><span class="p">,</span> 
<span class="k">sum</span><span class="p">(</span><span class="k">case</span> <span class="n">deptno</span> <span class="k">WHEN</span> <span class="mi">10</span> <span class="k">THEN</span> <span class="n">sal</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">END</span><span class="p">)</span> <span class="nv">"10ë²ˆ ë¶€ì„œ"</span><span class="p">,</span>
<span class="k">sum</span><span class="p">(</span><span class="k">case</span> <span class="n">deptno</span> <span class="k">WHEN</span> <span class="mi">20</span> <span class="k">THEN</span> <span class="n">sal</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">END</span><span class="p">)</span> <span class="nv">"20ë²ˆ ë¶€ì„œ"</span><span class="p">,</span>
<span class="k">sum</span><span class="p">(</span><span class="k">case</span> <span class="n">deptno</span> <span class="k">WHEN</span> <span class="mi">30</span> <span class="k">THEN</span> <span class="n">sal</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">END</span><span class="p">)</span> <span class="nv">"30ë²ˆ ë¶€ì„œ"</span><span class="p">,</span>
<span class="k">sum</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="nv">"ê¸‰ì—¬ í•©ê³„"</span>
<span class="k">FROM</span> <span class="n">emp</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">job</span><span class="p">;</span>

<span class="c1">-- ì‚¬ì›í…Œì´ë¸”(emp)ì— ì‚¬ì›ëª…ê³¼ ë¶€ì„œí…Œì´ë¸”(dept)ì— ê·¸ ì‚¬ì›ì˜ ë¶€ì„œëª…ì„ ì¶œë ¥</span>
<span class="k">SELECT</span> <span class="n">ename</span><span class="p">,</span> <span class="n">dname</span>
<span class="k">FROM</span> <span class="n">emp</span><span class="p">,</span> <span class="n">dept</span><span class="p">;</span> <span class="c1">-- Cartesian Product</span>

<span class="c1">-- 1. ì¡°ì¸(JOIN) : ë‘í…Œì´ë¸”ì— .ìœ¼ë¡œ ì—°ê²°ê³ ë¦¬ë¥¼ ë§ºì–´ ì—°ê²°í•œë‹¤.</span>
<span class="k">SELECT</span> <span class="n">emp</span><span class="p">.</span><span class="n">ename</span><span class="p">,</span> <span class="n">dept</span><span class="p">.</span><span class="n">dname</span><span class="p">,</span> <span class="n">emp</span><span class="p">.</span><span class="n">deptno</span>
<span class="k">FROM</span> <span class="n">emp</span><span class="p">,</span> <span class="n">dept</span>
<span class="k">WHERE</span> <span class="n">emp</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">dept</span><span class="p">.</span><span class="n">deptno</span><span class="p">;</span>

<span class="c1">-- 2. ë‚´ë¶€ ì¡°ì¸ </span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="n">deptno</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span><span class="p">,</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">WHERE</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span><span class="p">;</span>

<span class="c1">-- 2-1. (ANSIì¡°ì¸ : í‘œì¤€í™”)INNER JOIN</span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">enmae</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span> <span class="n">deptno</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span><span class="p">;</span>

<span class="c1">-- 3. ì™¸ë¶€ ì¡°ì¸ : ì—†ëŠ” ë°ì´í„°ë¥¼ í¬í•¨í•˜ì—¬ ì¡°ì¸</span>
<span class="c1">-- (+) : í•´ë‹¹ ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•Šë”ë¼ë„ ì´ë¥¼ ë¬´ì‹œí•˜ê³  ì¡°ì¸ì— ì°¸ì—¬</span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="n">deptno</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span><span class="p">,</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">WHERE</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span><span class="p">(</span><span class="o">+</span><span class="p">);</span>

<span class="c1">-- ë¶€ì„œí…Œì´ë¸”ì´ ì—†ëŠ” ë¶€ì„œê°€ ì¶œë ¥ëœë‹¤. </span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="n">deptno</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span><span class="p">,</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">WHERE</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span><span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span><span class="p">;</span> 

<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="n">deptno</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span><span class="p">,</span> <span class="n">dept</span> <span class="n">d</span>
<span class="c1">-- WHERE e.deptno(+) = d.deptno(+); -- ì—ëŸ¬ </span>

<span class="c1">-- 3-1. (ANSIì¡°ì¸ : í‘œì¤€í™”)LEFT OUTER JOIN, RIGHT OUTER JOIN</span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span> <span class="n">deptno</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span> <span class="k">LEFT</span> <span class="k">OUTER</span> <span class="k">JOIN</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span> <span class="n">deptno</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span> <span class="k">RIGHT</span> <span class="k">OUTER</span> <span class="k">JOIN</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span><span class="p">;</span>

<span class="c1">-- ì–‘ìª½ì´ ì—†ëŠ” í…Œì´ë¸” ê°€ëŠ¥</span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span> <span class="n">deptno</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span> <span class="k">FULL</span> <span class="k">OUTER</span> <span class="k">JOIN</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span><span class="p">;</span>

<span class="c1">-- 1. ê° ì‚¬ì›ì˜ ë§¤ë‹ˆì €ë¥¼ ê²€ìƒ‰(self join)</span>
<span class="c1">-- ë‚´ë¶€ì¡°ì¸</span>
<span class="k">SELECT</span> <span class="n">e1</span><span class="p">.</span><span class="n">empno</span> <span class="n">empno</span><span class="p">,</span> <span class="n">e1</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">e1</span><span class="p">.</span><span class="n">mgr</span> <span class="n">mgr</span><span class="p">,</span> <span class="n">e2</span><span class="p">.</span><span class="n">ename</span> <span class="n">boss</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e1</span><span class="p">,</span> <span class="n">emp</span> <span class="n">e2</span>
<span class="k">WHERE</span> <span class="n">e1</span><span class="p">.</span><span class="n">mgr</span> <span class="o">=</span> <span class="n">e2</span><span class="p">.</span><span class="n">empno</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="n">e1</span><span class="p">.</span><span class="n">empno</span> <span class="n">empno</span><span class="p">,</span> <span class="n">e1</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">e1</span><span class="p">.</span><span class="n">mgr</span> <span class="n">mgr</span><span class="p">,</span> <span class="n">e2</span><span class="p">.</span><span class="n">ename</span> <span class="n">boss</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e1</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">emp</span> <span class="n">e2</span>
<span class="k">ON</span> <span class="n">e1</span><span class="p">.</span><span class="n">mgr</span> <span class="o">=</span> <span class="n">e2</span><span class="p">.</span><span class="n">empno</span><span class="p">;</span>

<span class="c1">-- ì™¸ë¶€ì¡°ì¸</span>
<span class="k">SELECT</span> <span class="n">e1</span><span class="p">.</span><span class="n">empno</span> <span class="n">empno</span><span class="p">,</span> <span class="n">e1</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">e1</span><span class="p">.</span><span class="n">mgr</span> <span class="n">mgr</span><span class="p">,</span> <span class="n">e2</span><span class="p">.</span><span class="n">ename</span> <span class="n">boss</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e1</span><span class="p">,</span> <span class="n">emp</span> <span class="n">e2</span>
<span class="k">WHERE</span> <span class="n">e1</span><span class="p">.</span><span class="n">mgr</span> <span class="o">=</span> <span class="n">e2</span><span class="p">.</span><span class="n">empno</span><span class="p">(</span><span class="o">+</span><span class="p">);</span>

<span class="k">SELECT</span> <span class="n">e1</span><span class="p">.</span><span class="n">empno</span> <span class="n">empno</span><span class="p">,</span> <span class="n">e1</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">e1</span><span class="p">.</span><span class="n">mgr</span> <span class="n">mgr</span><span class="p">,</span> <span class="n">e2</span><span class="p">.</span><span class="n">ename</span> <span class="n">boss</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e1</span> <span class="k">LEFT</span> <span class="k">OUTER</span> <span class="k">JOIN</span> <span class="n">emp</span> <span class="n">e2</span>
<span class="k">ON</span> <span class="n">e1</span><span class="p">.</span><span class="n">mgr</span> <span class="o">=</span> <span class="n">e2</span><span class="p">.</span><span class="n">empno</span><span class="p">;</span>

<span class="c1">-- [ì—°ìŠµë¬¸ì œ]</span>
<span class="c1">-- 1. EMP í…Œì´ë¸”ì—ì„œ ì‚¬ì›ë²ˆí˜¸, ì´ë¦„, ì—…ë¬´, ë¶€ì„œë²ˆí˜¸ì™€ DEPT í…Œì´ë¸”ì—ì„œ ë¶€ì„œëª…, ê·¼ë¬´ì§€ë¥¼ ì¶œë ¥</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">emp</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">dept</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">empno</span> <span class="n">empno</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">job</span> <span class="n">job</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="n">deptno</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">loc</span> <span class="n">loc</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span><span class="p">,</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">WHERE</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">empno</span> <span class="n">empno</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">job</span> <span class="n">job</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="n">deptno</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">loc</span> <span class="n">loc</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span><span class="p">;</span>

<span class="c1">-- 2. SALESMAN ì‚¬ì›ë§Œ ì‚¬ì›ë²ˆí˜¸, ì´ë¦„, ê¸‰ì—¬, ë¶€ì„œëª…, ê·¼ë¬´ì§€ë¥¼ ì¶œë ¥</span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">empno</span> <span class="n">empno</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">sal</span> <span class="n">sal</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">loc</span> <span class="n">loc</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span><span class="p">,</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">WHERE</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span> <span class="k">AND</span> <span class="n">job</span> <span class="o">=</span> <span class="s1">'SALESMAN'</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">empno</span> <span class="n">empno</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">sal</span> <span class="n">sal</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">loc</span> <span class="n">loc</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span>
<span class="k">WHERE</span> <span class="n">job</span> <span class="o">=</span> <span class="s1">'SALESMAN'</span><span class="p">;</span>

<span class="c1">-- 3. ë³´ë„ˆìŠ¤(comm)ë¥¼ ë°›ëŠ” ì‚¬ì›ì— ëŒ€í•´ ì´ë¦„, ë¶€ì„œëª…, ìœ„ì¹˜ë¥¼ ì¶œë ¥</span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="n">deptno</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">loc</span> <span class="n">loc</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span><span class="p">,</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">WHERE</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span> <span class="k">AND</span> <span class="n">nvl</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">comm</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">ename</span> <span class="n">ename</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="n">deptno</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">loc</span> <span class="n">loc</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span>
<span class="k">WHERE</span> <span class="n">nvl</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">comm</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1">-- 4. ë¶€ì„œë³„ ë¶€ì„œëª…ê³¼ ê¸‰ì—¬ í•©ê³„ë¥¼ ì¶œë ¥</span>
<span class="k">SELECT</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">sum</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span><span class="p">,</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">WHERE</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span> <span class="n">dname</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">sum</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">dept</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">deptno</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">deptno</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">d</span><span class="p">.</span><span class="n">dname</span><span class="p">;</span>

<span class="cm">/* ì§‘í•©(SET)
    - UNION     í•©ì§‘í•©
    - UNION ALL í•©ì§‘í•© : ì¤‘ë³µ í—ˆìš©
    - INTERSECT êµì§‘í•©
    - MINUS     ì°¨ì§‘í•©
 */</span>
 <span class="c1">-- ì—…ë¬´ê°€ CLERKì¸ ì‚¬ì›ì˜ ì‚¬ë²ˆ, ì‚¬ì›ëª…, ì—…ë¬´, ë¶€ì„œë²ˆí˜¸ ì¶œë ¥</span>
 <span class="c1">-- 10ë²ˆ ë¶€ì„œì˜ ì‚¬ë²ˆ, ì‚¬ì›ëª…, ì—…ë¬´, ë¶€ì„œë²ˆí˜¸ ì¶œë ¥</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">emp</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="n">empno</span><span class="p">,</span> <span class="n">ename</span><span class="p">,</span> <span class="n">job</span><span class="p">,</span> <span class="n">deptno</span> <span class="k">FROM</span> <span class="n">emp</span> <span class="k">WHERE</span> <span class="n">job</span> <span class="o">=</span> <span class="s1">'CLERK'</span>
<span class="n">MINUS</span> <span class="c1">-- ì§‘í•©ê³¼ ê´€ë ¨ ëœ ë‚´ìš©</span>
<span class="k">SELECT</span> <span class="n">empno</span><span class="p">,</span> <span class="n">ename</span><span class="p">,</span> <span class="n">job</span><span class="p">,</span> <span class="n">deptno</span> <span class="k">FROM</span> <span class="n">emp</span> <span class="k">WHERE</span> <span class="n">deptno</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="c1">-- ì „ì²´ ì‚¬ì›ë“¤ ì¤‘ í‰ê· ê¸‰ì—¬ë³´ë‹¤ ë‚®ì€ ê¸‰ì—¬ë¥¼ ë°›ëŠ” ì‚¬ì›ì˜ ëª…ë‹¨ì„ ì¡°íšŒ</span>
<span class="k">SELECT</span> <span class="k">avg</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">emp</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="n">empno</span><span class="p">,</span> <span class="n">ename</span><span class="p">,</span> <span class="n">sal</span>
<span class="k">FROM</span> <span class="n">emp</span>
<span class="k">WHERE</span> <span class="n">sal</span> <span class="o">&lt;</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">avg</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">emp</span><span class="p">);</span>

<span class="c1">-- ì›”ê¸‰ì„ ê°€ì¥ ë§ì´ ë°›ëŠ” ì‚¬ëŒì˜ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê¸°</span>
<span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">emp</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="n">empno</span><span class="p">,</span> <span class="n">ename</span><span class="p">,</span> <span class="n">sal</span>
<span class="k">FROM</span> <span class="n">emp</span>
<span class="k">WHERE</span> <span class="n">sal</span> <span class="o">=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">emp</span><span class="p">);</span>

<span class="c1">-- í‰ê· ê¸‰ì—¬ë³´ë‹¤ ë†’ê³  ìµœëŒ€ ê¸‰ì—¬ë³´ë‹¤ ë‚®ì€ ì›”ê¸‰ì„ ë°›ëŠ” ì‚¬ì› ëª…ë‹¨ ì¡°íšŒ</span>
<span class="k">SELECT</span> <span class="n">empno</span><span class="p">,</span> <span class="n">ename</span><span class="p">,</span> <span class="n">sal</span>
<span class="k">FROM</span> <span class="n">emp</span>
<span class="k">WHERE</span> <span class="n">sal</span> <span class="o">&gt;</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">avg</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">emp</span><span class="p">)</span> <span class="k">AND</span> <span class="n">sal</span> <span class="o">&lt;</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">emp</span><span class="p">);</span>

<span class="k">SELECT</span> <span class="n">empno</span><span class="p">,</span> <span class="n">ename</span><span class="p">,</span> <span class="n">sal</span>
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e1</span><span class="p">,</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">avg</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">avg</span><span class="p">,</span> <span class="k">max</span><span class="p">(</span><span class="n">sal</span><span class="p">)</span> <span class="k">max</span> <span class="k">FROM</span> <span class="n">emp</span><span class="p">)</span> <span class="n">e2</span>
<span class="k">WHERE</span> <span class="n">e1</span><span class="p">.</span><span class="n">sal</span> <span class="o">&gt;</span> <span class="n">e2</span><span class="p">.</span><span class="k">avg</span> <span class="k">AND</span> <span class="n">e1</span><span class="p">.</span><span class="n">sal</span> <span class="o">&lt;</span> <span class="n">e2</span><span class="p">.</span><span class="k">max</span><span class="p">;</span>

<span class="c1">-- ì›”ê¸‰ìˆœìœ¼ë¡œ ìƒìœ„ 10ëª…ì˜ ëª…ë‹¨ì„ ì¶œë ¥(rownum ì´ìš©)</span>
<span class="k">SELECT</span> <span class="n">empno</span><span class="p">,</span> <span class="n">ename</span><span class="p">,</span> <span class="n">sal</span> <span class="k">FROM</span> <span class="n">emp</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">nvl</span><span class="p">(</span><span class="n">sal</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">DESC</span><span class="p">;</span>
<span class="c1">-- ì •ë ¬ì„ í•œ í›„ 10ëª…ì„ ë½‘ì•„ë‚¸ ê²ƒ</span>
<span class="k">SELECT</span> <span class="n">empno</span><span class="p">,</span> <span class="n">ename</span><span class="p">,</span> <span class="n">sal</span>
<span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">empno</span><span class="p">,</span> <span class="n">ename</span><span class="p">,</span> <span class="n">sal</span> <span class="k">FROM</span> <span class="n">emp</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">nvl</span><span class="p">(</span><span class="n">sal</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">DESC</span><span class="p">)</span>
<span class="k">WHERE</span> <span class="n">ROWNUM</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">;</span>

<span class="c1">-- ë°”ë¡œ 10ëª…ì„ ë½‘ê³  ì •ë ¬ì„ í•œ ê²ƒ(í‹€ë¦°ê±°)</span>
<span class="k">SELECT</span> <span class="n">empno</span><span class="p">,</span> <span class="n">ename</span><span class="p">,</span> <span class="n">sal</span> 
<span class="k">FROM</span> <span class="n">emp</span> <span class="n">e</span>
<span class="k">WHERE</span> <span class="n">ROWNUM</span> <span class="o">&lt;=</span> <span class="mi">10</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">nvl</span><span class="p">(</span><span class="n">sal</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">DESC</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">employees</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">departments</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">jobs</span><span class="p">;</span>
<span class="c1">-- 1. ì‚¬ì›ë²ˆí˜¸, ì‚¬ì›ëª…, ë¶€ì„œëª… ì¶œë ¥</span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">employee_id</span> <span class="n">id</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">first_name</span> <span class="o">||</span>  <span class="n">e</span><span class="p">.</span><span class="n">last_name</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">department_name</span> <span class="n">depart</span>
<span class="k">FROM</span> <span class="n">employees</span> <span class="n">e</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">departments</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">department_id</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">department_id</span><span class="p">;</span>

<span class="c1">-- 2. ì‚¬ì›ë²ˆí˜¸, ì‚¬ì›ëª…, ì—…ë¬´ëª…, ë¶€ì„œëª… ì¶œë ¥</span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">employee_id</span> <span class="n">id</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">first_name</span> <span class="o">||</span> <span class="n">e</span><span class="p">.</span><span class="n">last_name</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">j</span><span class="p">.</span><span class="n">job_title</span> <span class="n">job</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">department_name</span> <span class="n">depart</span>
<span class="k">FROM</span> <span class="n">employees</span> <span class="n">e</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">departments</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">department_id</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">department_id</span> 
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">jobs</span> <span class="n">j</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">job_id</span> <span class="o">=</span> <span class="n">j</span><span class="p">.</span><span class="n">job_id</span><span class="p">;</span>

<span class="c1">-- 3. ì‚¬ì›ë²ˆí˜¸, ì‚¬ì›ëª…, ë¶€ì„œëª…, ìœ„ì¹˜ ì¶œë ¥</span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">employee_id</span> <span class="n">id</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">first_name</span> <span class="o">||</span> <span class="n">e</span><span class="p">.</span><span class="n">last_name</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">department_name</span> <span class="n">depart</span><span class="p">,</span> <span class="n">l</span><span class="p">.</span><span class="n">city</span> <span class="n">city</span>
<span class="k">FROM</span> <span class="n">employees</span> <span class="n">e</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">departments</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">department_id</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">department_id</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">locations</span> <span class="n">l</span>
<span class="k">ON</span> <span class="n">d</span><span class="p">.</span><span class="n">location_id</span> <span class="o">=</span> <span class="n">l</span><span class="p">.</span><span class="n">location_id</span><span class="p">;</span>

<span class="c1">-- 4. ì‚¬ì›ë²ˆí˜¸, ì‚¬ì›ëª…, ì—…ë¬´ëª…, ë¶€ì„œëª…, ìœ„ì¹˜ì¶œë ¥</span>
<span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">employee_id</span> <span class="n">id</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">first_name</span> <span class="o">||</span> <span class="n">e</span><span class="p">.</span><span class="n">last_name</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">j</span><span class="p">.</span><span class="n">job_title</span> <span class="n">job</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">department_name</span> <span class="n">depart</span><span class="p">,</span> <span class="n">l</span><span class="p">.</span><span class="n">city</span> <span class="n">city</span>
<span class="k">FROM</span> <span class="n">employees</span> <span class="n">e</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">jobs</span> <span class="n">j</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">job_id</span> <span class="o">=</span> <span class="n">j</span><span class="p">.</span><span class="n">job_id</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">departments</span> <span class="n">d</span>
<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">department_id</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">department_id</span>
<span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">locations</span> <span class="n">l</span>
<span class="k">ON</span> <span class="n">d</span><span class="p">.</span><span class="n">location_id</span> <span class="o">=</span> <span class="n">l</span><span class="p">.</span><span class="n">location_id</span><span class="p">;</span>

<span class="c1">-- 5. ì…ì‚¬ë…„ë„ë³„ ìµœê³  ì›”ê¸‰ì„ ë°›ëŠ” ì‚¬ì›ì˜ ì´ë¦„ê³¼ ë¶€ì„œëª…ì„ ì¶œë ¥</span>
<span class="c1">-- ë…„ë„ë³„ ìµœê³  ì›”ê¸‰ ë°›ëŠ” ìˆœì„œ</span>
<span class="k">SELECT</span> <span class="n">to_char</span><span class="p">(</span><span class="n">hire_date</span><span class="p">,</span> <span class="s1">'YYYY'</span><span class="p">)</span> <span class="nb">year</span><span class="p">,</span> <span class="k">max</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span> <span class="n">maxsal</span> <span class="k">FROM</span> <span class="n">employees</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">to_char</span><span class="p">(</span><span class="n">hire_date</span><span class="p">,</span> <span class="s1">'YYYY'</span><span class="p">)</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="nb">year</span><span class="p">;</span>

<span class="k">SELECT</span>  <span class="n">e1</span><span class="p">.</span><span class="n">first_name</span> <span class="o">||</span> <span class="n">e1</span><span class="p">.</span><span class="n">last_name</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">e1</span><span class="p">.</span><span class="n">hire_date</span> <span class="n">h_date</span><span class="p">,</span> <span class="n">e1</span><span class="p">.</span><span class="n">salary</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">department_name</span> <span class="n">depart</span>
<span class="k">FROM</span>    <span class="n">employees</span> <span class="n">e1</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">to_char</span><span class="p">(</span><span class="n">hire_date</span><span class="p">,</span> <span class="s1">'YYYY'</span><span class="p">)</span> <span class="nb">year</span><span class="p">,</span> <span class="k">max</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span> <span class="n">maxsal</span> 
                                <span class="k">FROM</span> <span class="n">employees</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">to_char</span><span class="p">(</span><span class="n">hire_date</span><span class="p">,</span> <span class="s1">'YYYY'</span><span class="p">)</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="nb">year</span><span class="p">)</span> <span class="n">e2</span>
<span class="k">ON</span> <span class="n">to_char</span><span class="p">(</span><span class="n">e1</span><span class="p">.</span><span class="n">hire_date</span><span class="p">,</span> <span class="s1">'YYYY'</span><span class="p">)</span> <span class="o">=</span> <span class="n">e2</span><span class="p">.</span><span class="nb">year</span> <span class="k">AND</span> <span class="n">e1</span><span class="p">.</span><span class="n">salary</span> <span class="o">=</span> <span class="n">e2</span><span class="p">.</span><span class="n">maxsal</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">departments</span> <span class="n">d</span> <span class="k">ON</span> <span class="n">e1</span><span class="p">.</span><span class="n">department_id</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">department_id</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">hire_date</span><span class="p">;</span>
</code></pre></div></div>
:ET